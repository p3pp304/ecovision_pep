<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36" version="29.2.9">
  <diagram name="Pagina-1" id="RWpUKGmjLZsWPOUX3Iaw">
    <mxGraphModel dx="1281" dy="567" grid="0" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1169" pageHeight="827" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="C0RQJoq_YbQeUBVIWwAn-1" parent="1" style="swimlane;whiteSpace=wrap;html=1;" value="ATTORI e OGGETTI" vertex="1">
          <mxGeometry height="248" width="286" x="31" y="25" as="geometry" />
        </mxCell>
        <mxCell id="C0RQJoq_YbQeUBVIWwAn-2" parent="C0RQJoq_YbQeUBVIWwAn-1" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;fontSize=16;strokeWidth=2;" value="&lt;font style=&quot;font-size: 11px;&quot;&gt;&lt;b&gt;1) UTENTE:&lt;/b&gt; compie le azioni e dà gli input (click, immagini, città)&lt;/font&gt;&lt;div&gt;&lt;font style=&quot;font-size: 11px;&quot;&gt;&lt;b&gt;2) APP UI:&lt;/b&gt; interfaccia Streamlit (file main.py)&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 11px;&quot;&gt;&lt;b&gt;3) GeoLoader (GPS):&lt;/b&gt; fornisce i dati geografici all&#39;inizio (selectbox)&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 11px;&quot;&gt;&lt;b&gt;4) AIEngine:&lt;/b&gt; gestisce l&#39;interazione con l&#39;AI Gemini e il prompt&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 11px;&quot;&gt;&lt;b&gt;5) Gemini API:&lt;/b&gt; esegue l&#39;analisi dell&#39;immagine e restituisce i risultati in formato JSON&lt;/font&gt;&lt;/div&gt;" vertex="1">
          <mxGeometry height="208" width="267" x="9.5" y="20" as="geometry" />
        </mxCell>
        <mxCell id="C0RQJoq_YbQeUBVIWwAn-3" parent="C0RQJoq_YbQeUBVIWwAn-1" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" value="&lt;font style=&quot;color: rgb(255, 5, 5);&quot;&gt;&lt;b&gt;NOTA!: &lt;/b&gt;&lt;/font&gt;dovremo mettere le linee di vita adeguate" vertex="1">
          <mxGeometry height="30" width="292" x="-6" y="218" as="geometry" />
        </mxCell>
        <mxCell id="TxsK_ulot_Mn7s9XiAge-1" parent="1" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;dropTarget=0;collapsible=0;recursiveResize=0;outlineConnect=0;portConstraint=eastwest;newEdgeStyle={&quot;curved&quot;:0,&quot;rounded&quot;:0};" value="&lt;b&gt;Utente&lt;/b&gt;" vertex="1">
          <mxGeometry height="526" width="100" x="88" y="296" as="geometry" />
        </mxCell>
        <mxCell id="TxsK_ulot_Mn7s9XiAge-12" parent="TxsK_ulot_Mn7s9XiAge-1" style="html=1;points=[[0,0,0,0,5],[0,1,0,0,-5],[1,0,0,0,5],[1,1,0,0,-5]];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;curved&quot;:0,&quot;rounded&quot;:0};" value="" vertex="1">
          <mxGeometry height="410" width="10" x="45" y="101" as="geometry" />
        </mxCell>
        <mxCell id="TxsK_ulot_Mn7s9XiAge-2" parent="1" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;dropTarget=0;collapsible=0;recursiveResize=0;outlineConnect=0;portConstraint=eastwest;newEdgeStyle={&quot;curved&quot;:0,&quot;rounded&quot;:0};" value="&lt;b&gt;APP&lt;/b&gt;" vertex="1">
          <mxGeometry height="523" width="100" x="284" y="296" as="geometry" />
        </mxCell>
        <mxCell id="TxsK_ulot_Mn7s9XiAge-9" parent="TxsK_ulot_Mn7s9XiAge-2" style="html=1;points=[[0,0,0,0,5],[0,1,0,0,-5],[1,0,0,0,5],[1,1,0,0,-5]];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;curved&quot;:0,&quot;rounded&quot;:0};" value="" vertex="1">
          <mxGeometry height="448" width="10" x="45" y="57" as="geometry" />
        </mxCell>
        <mxCell id="TxsK_ulot_Mn7s9XiAge-3" parent="1" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;dropTarget=0;collapsible=0;recursiveResize=0;outlineConnect=0;portConstraint=eastwest;newEdgeStyle={&quot;curved&quot;:0,&quot;rounded&quot;:0};" value="&lt;b&gt;GeoLoader&lt;/b&gt;" vertex="1">
          <mxGeometry height="446" width="100" x="503" y="297" as="geometry" />
        </mxCell>
        <mxCell id="TxsK_ulot_Mn7s9XiAge-8" parent="TxsK_ulot_Mn7s9XiAge-3" style="html=1;points=[[0,0,0,0,5],[0,1,0,0,-5],[1,0,0,0,5],[1,1,0,0,-5]];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;curved&quot;:0,&quot;rounded&quot;:0};" value="" vertex="1">
          <mxGeometry height="80" width="10" x="45" y="54" as="geometry" />
        </mxCell>
        <mxCell id="TxsK_ulot_Mn7s9XiAge-4" parent="1" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;dropTarget=0;collapsible=0;recursiveResize=0;outlineConnect=0;portConstraint=eastwest;newEdgeStyle={&quot;curved&quot;:0,&quot;rounded&quot;:0};" value="&lt;b&gt;AI Engine&lt;/b&gt;" vertex="1">
          <mxGeometry height="444" width="100" x="717" y="299" as="geometry" />
        </mxCell>
        <mxCell id="TxsK_ulot_Mn7s9XiAge-17" parent="TxsK_ulot_Mn7s9XiAge-4" style="html=1;points=[[0,0,0,0,5],[0,1,0,0,-5],[1,0,0,0,5],[1,1,0,0,-5]];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;curved&quot;:0,&quot;rounded&quot;:0};" value="" vertex="1">
          <mxGeometry height="267" width="10" x="45" y="141" as="geometry" />
        </mxCell>
        <mxCell id="TxsK_ulot_Mn7s9XiAge-5" parent="1" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;dropTarget=0;collapsible=0;recursiveResize=0;outlineConnect=0;portConstraint=eastwest;newEdgeStyle={&quot;curved&quot;:0,&quot;rounded&quot;:0};" value="&lt;b&gt;Gemini&lt;/b&gt;" vertex="1">
          <mxGeometry height="450" width="100" x="961" y="293" as="geometry" />
        </mxCell>
        <mxCell id="TxsK_ulot_Mn7s9XiAge-20" parent="TxsK_ulot_Mn7s9XiAge-5" style="html=1;points=[[0,0,0,0,5],[0,1,0,0,-5],[1,0,0,0,5],[1,1,0,0,-5]];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;curved&quot;:0,&quot;rounded&quot;:0};" value="" vertex="1">
          <mxGeometry height="118.5" width="10" x="45" y="195.5" as="geometry" />
        </mxCell>
        <mxCell id="TxsK_ulot_Mn7s9XiAge-6" edge="1" parent="1" style="html=1;verticalAlign=bottom;endArrow=block;curved=0;rounded=0;" value="carica_dati_geografici()">
          <mxGeometry relative="1" width="80" as="geometry">
            <mxPoint x="339" y="366" as="sourcePoint" />
            <mxPoint x="546" y="366" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="TxsK_ulot_Mn7s9XiAge-7" edge="1" parent="1" style="html=1;verticalAlign=bottom;endArrow=open;dashed=1;endSize=8;curved=0;rounded=0;" value="Lista comuni">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="546" y="388" as="sourcePoint" />
            <mxPoint x="339" y="388" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="TxsK_ulot_Mn7s9XiAge-10" parent="1" style="swimlane;whiteSpace=wrap;html=1;" value="MESSAGGI" vertex="1">
          <mxGeometry height="266" width="369" x="385" y="25" as="geometry" />
        </mxCell>
        <mxCell id="TxsK_ulot_Mn7s9XiAge-11" parent="TxsK_ulot_Mn7s9XiAge-10" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" value="1) L&#39;UI fa creare una lista di comuni al modulo GeoLoader con la funzione carica_dati_geografici() ricevendo tale lista come risposta&amp;nbsp;&lt;div&gt;2) L&#39;utente seleziona la città, carica l&#39;immagine e clicca su &quot;Analizza rifiuto&quot;&lt;/div&gt;&lt;div&gt;3) L&#39;App UI delega l&#39;analisi all&#39;AI Engine passando i parametri img, key, città&lt;/div&gt;&lt;div&gt;4) L&#39;AI Engine richiede il servizio esterno dell&#39;API Gemini che fornisce un messaggio di analisi del rifiuto in formato JSON. Quindi l&#39;AI Engine trasferisce tali risultati all&#39;App UI&lt;/div&gt;&lt;div&gt;5) L&#39;UI gestisce ed elabora la logica dei colori in base ai dati ricevuti (auto-call) e mostra i risultati all&#39;utente&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;color: rgb(44, 11, 201);&quot;&gt;&lt;b style=&quot;&quot;&gt;6) (OPZIONALE)&lt;/b&gt; Se il rifiuto è Speciale e va smistato in un&#39;Isola Ecologica viene mostrata una finestra di Maps con l&#39;isola ecologica più vicina&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#2c0bc9&quot;&gt;&lt;b&gt;7) (OPZIONALE): &lt;/b&gt;Se l&#39;Utente lo desidera può chiedere dei chiarimenti ad un ChatBot&lt;/font&gt;&lt;/div&gt;" vertex="1">
          <mxGeometry height="243" width="351" x="7" y="23" as="geometry" />
        </mxCell>
        <mxCell id="TxsK_ulot_Mn7s9XiAge-13" edge="1" parent="1" style="html=1;verticalAlign=bottom;endArrow=block;curved=0;rounded=0;" value="Seleziona città da selectbox o spunta">
          <mxGeometry relative="1" width="80" as="geometry">
            <mxPoint x="143" y="425" as="sourcePoint" />
            <mxPoint x="328" y="425" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="TxsK_ulot_Mn7s9XiAge-14" edge="1" parent="1" style="html=1;verticalAlign=bottom;endArrow=block;curved=0;rounded=0;" value="carica immagine da analizzare">
          <mxGeometry relative="1" width="80" as="geometry">
            <mxPoint x="143" y="482" as="sourcePoint" />
            <mxPoint x="329" y="482" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="TxsK_ulot_Mn7s9XiAge-15" edge="1" parent="1" style="html=1;verticalAlign=bottom;endArrow=block;curved=0;rounded=0;" value="Clicca &quot;Analizza Rifiuto&quot;">
          <mxGeometry relative="1" width="80" as="geometry">
            <mxPoint x="144" y="506" as="sourcePoint" />
            <mxPoint x="328" y="506" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="TxsK_ulot_Mn7s9XiAge-16" edge="1" parent="1" style="html=1;verticalAlign=bottom;endArrow=block;curved=0;rounded=0;" target="TxsK_ulot_Mn7s9XiAge-17" value="analizza_immagine(img, key, citta)">
          <mxGeometry relative="1" width="80" as="geometry">
            <mxPoint x="341" y="529" as="sourcePoint" />
            <mxPoint x="421" y="529" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="TxsK_ulot_Mn7s9XiAge-19" edge="1" parent="1" style="html=1;verticalAlign=bottom;endArrow=block;curved=0;rounded=0;" target="TxsK_ulot_Mn7s9XiAge-5" value="models.generate_content(prompt, img)">
          <mxGeometry relative="1" width="80" as="geometry">
            <mxPoint x="771" y="554" as="sourcePoint" />
            <mxPoint x="851" y="554" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="TxsK_ulot_Mn7s9XiAge-21" edge="1" parent="1" style="html=1;verticalAlign=bottom;endArrow=open;dashed=1;endSize=8;curved=0;rounded=0;" value="Risposta JSON">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1004" y="576" as="sourcePoint" />
            <mxPoint x="772" y="576" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="TxsK_ulot_Mn7s9XiAge-22" edge="1" parent="1" style="html=1;verticalAlign=bottom;endArrow=open;dashed=1;endSize=8;curved=0;rounded=0;" value="Dati Rifiuto">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="761" y="594" as="sourcePoint" />
            <mxPoint x="336" y="594" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="TxsK_ulot_Mn7s9XiAge-23" edge="1" parent="1" style="html=1;verticalAlign=bottom;endArrow=open;dashed=1;endSize=8;curved=0;rounded=0;" value="Mostra risultati (con logica colore)">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="327" y="664" as="sourcePoint" />
            <mxPoint x="142" y="664" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="TxsK_ulot_Mn7s9XiAge-29" edge="1" parent="1" style="html=1;align=left;spacingLeft=2;endArrow=block;rounded=0;edgeStyle=orthogonalEdgeStyle;curved=0;rounded=0;" value="Processa logica colore">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="368" y="641" />
            </Array>
            <mxPoint x="338" y="611" as="sourcePoint" />
            <mxPoint x="343" y="641" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="TxsK_ulot_Mn7s9XiAge-30" parent="1" style="swimlane;whiteSpace=wrap;html=1;" value="LOOP" vertex="1">
          <mxGeometry height="185" width="272" x="826" y="25" as="geometry" />
        </mxCell>
        <mxCell id="TxsK_ulot_Mn7s9XiAge-31" parent="TxsK_ulot_Mn7s9XiAge-30" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" value="1) Opt (Utente-APP): se il rifiuto è speciale viene mostrata la finestra di Maps con l&#39;isola ecologica più vicina&lt;div&gt;2) Opt (Utente-APP): se l&#39;Utente spunta la casella o seleziona il comune manualmente viene mostrata la finestra di Maps con la posizione&lt;/div&gt;&lt;div&gt;3) Opt (Utente-APP): l&#39;utente PUO&#39; comunicare con un chatbot nel caso di dubbi e delucidazioni&lt;/div&gt;" vertex="1">
          <mxGeometry height="152" width="250" x="11" y="24" as="geometry" />
        </mxCell>
        <mxCell id="38RKcHRO57MC3IT0FOu2-1" parent="1" style="shape=umlFrame;whiteSpace=wrap;html=1;pointerEvents=0;" value="opt" vertex="1">
          <mxGeometry height="67" width="272" x="83" y="387" as="geometry" />
        </mxCell>
        <mxCell id="38RKcHRO57MC3IT0FOu2-2" parent="1" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" value="&lt;b&gt;Se l&#39;utente seleziona il comune&lt;/b&gt;" vertex="1">
          <mxGeometry height="30" width="200" x="139" y="384" as="geometry" />
        </mxCell>
        <mxCell id="38RKcHRO57MC3IT0FOu2-3" edge="1" parent="1" style="html=1;verticalAlign=bottom;endArrow=open;dashed=1;endSize=8;curved=0;rounded=0;" value="Posizione su finestra Maps">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="326.5" y="446" as="sourcePoint" />
            <mxPoint x="142" y="446" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="38RKcHRO57MC3IT0FOu2-4" edge="1" parent="1" style="html=1;verticalAlign=bottom;endArrow=open;dashed=1;endSize=8;curved=0;rounded=0;" value="Fornisce finestra Maps con isola ecologica">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="327.5" y="717" as="sourcePoint" />
            <mxPoint x="142.5" y="717" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="38RKcHRO57MC3IT0FOu2-5" parent="1" style="shape=umlFrame;whiteSpace=wrap;html=1;pointerEvents=0;" value="opt" vertex="1">
          <mxGeometry height="57" width="272" x="91" y="671" as="geometry" />
        </mxCell>
        <mxCell id="38RKcHRO57MC3IT0FOu2-6" parent="1" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" value="&lt;b&gt;Se il rifiuto è speciale&lt;/b&gt;" vertex="1">
          <mxGeometry height="30" width="192" x="139" y="671" as="geometry" />
        </mxCell>
        <mxCell id="38RKcHRO57MC3IT0FOu2-7" parent="1" style="shape=umlFrame;whiteSpace=wrap;html=1;pointerEvents=0;" value="opt" vertex="1">
          <mxGeometry height="57" width="272" x="91" y="734" as="geometry" />
        </mxCell>
        <mxCell id="38RKcHRO57MC3IT0FOu2-8" parent="1" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" value="&lt;b&gt;Se l&#39;Utente vuole chiarimenti&lt;/b&gt;" vertex="1">
          <mxGeometry height="30" width="206" x="139" y="730" as="geometry" />
        </mxCell>
        <mxCell id="38RKcHRO57MC3IT0FOu2-9" edge="1" parent="1" style="html=1;verticalAlign=bottom;endArrow=block;curved=0;rounded=0;" value="Invia richiesta ad un chatbot">
          <mxGeometry relative="1" width="80" as="geometry">
            <mxPoint x="147" y="768" as="sourcePoint" />
            <mxPoint x="331" y="768" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="38RKcHRO57MC3IT0FOu2-10" edge="1" parent="1" style="html=1;verticalAlign=bottom;endArrow=open;dashed=1;endSize=8;curved=0;rounded=0;" value="Riceve la risposta">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="327.5" y="783" as="sourcePoint" />
            <mxPoint x="142.5" y="783" as="targetPoint" />
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
